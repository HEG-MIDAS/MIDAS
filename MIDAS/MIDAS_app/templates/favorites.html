{% extends 'layouts/base.html' %}
{% block extracss %}
<link rel="stylesheet" href="/static/css/favorite.css">
{% endblock %}
{% block body_content %}
<div class="midas-container container-fluid">
    <p class="h1">Favoris</p>
    <div class="d-flex w-100 flex-column align-items-center">
        {% for k,element in list.items  %}
        <div class="card mb-3 w-50">
            <div class="card-header row g-0 align-items-center justify-content-between">
                <div class="col-sm-6"><strong>{{ element.name }} ({{ element.slug }})</strong></div>
                <div class="col-sm-6 text-end">
                    <i title="Supprimer ce favoris" class="fa-solid fa-circle-xmark text-danger"></i>
                    <i class="fa-solid fa-circle-chevron-{%if k == 0%}up{%else%}down{%endif%}" data-bs-toggle="collapse" data-bs-target="#collapseGroup-{{k}}" aria-expanded="false" aria-controls="collapseGroup-{{k}}"></i>
                </div>
            </div>
            <div class="collapse {%if k == 0%}show{%endif%} row g-0 justify-content-center" id="collapseGroup-{{k}}">
                <div class="col-sm-10">
                    {% for fav in element.favorites  %}
                    <div class="row justify-content-between">
                        <ul class="col list-group list-group-flush">
                            <li class="list-group-item"><strong>De</strong> {{fav.starting_date}} <strong>à</strong> {{fav.ending_date}}</li>
                        </ul>
                    </div>
                    <div class="row justify-content-between">
                        <ul class="col-sm-5 list-group list-group-flush">
                            <li class="list-group-item text-center"><strong>Stations</strong> ({{fav.stations|length}})</li>
                            {% if fav.stations|length > 3 %}
                            <li class="list-group-item text-center">{{fav.stations.0}}</li>
                            <li class="list-group-item text-center">{{fav.stations.1}}</li>
                            <div class="collapse" id="collapseStations-{{fav.id}}">
                                {% for station in fav.stations|slice:"2:"  %}
                                <li class="list-group-item text-center">{{station}}</li>
                                {% endfor %}
                            </div>
                            <li class="list-group-item text-center text-primary" data-bs-toggle="collapse" data-bs-target="#collapseStations-{{fav.id}}" aria-expanded="false" aria-controls="collapseStations-{{fav.id}}"><i class="fa-solid fa-plus"></i> Voir plus</li>
                            {% else %}
                            {% for station in fav.stations  %}
                            <li class="list-group-item text-center">{{station}}</li>
                            {% endfor %}
                            {% endif %}
                        </ul>
                        <ul class="col-sm-5 list-group list-group-flush">
                            <li class="list-group-item text-center"><strong>Paramètres</strong> ({{fav.parameters|length}})</li>
                            {% if fav.parameters|length > 3 %}
                            <li class="list-group-item text-center">{{fav.parameters.0}}</li>
                            <li class="list-group-item text-center">{{fav.parameters.1}}</li>
                            <div class="collapse" id="collapseParameters-{{fav.id}}">
                                {% for parameter in fav.parameters|slice:"2:"  %}
                                <li class="list-group-item text-center">{{parameter}}</li>
                                {% endfor %}
                            </div>
                            <li class="list-group-item text-center text-primary" data-bs-toggle="collapse" data-bs-target="#collapseParameters-{{fav.id}}" aria-expanded="false" aria-controls="collapseParameters-{{fav.id}}"><i class="fa-solid fa-plus"></i> Voir plus</li>
                            {% else %}
                            {% for parameter in fav.parameters  %}
                            <li class="list-group-item text-center">{{parameter}}</li>
                            {% endfor %}
                            {% endif %}
                        </ul>
                    </div>

                    {% endfor %}
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
</div>
<script type="text/javascript">
    document.querySelectorAll('li[data-bs-toggle="collapse"]').forEach(el=>{
        el.addEventListener('click',()=>{
            if(el.innerHTML=='<i class="fa-solid fa-plus"></i> Voir plus')el.innerHTML='<i class="fa-solid fa-minus"></i> Voir moins'
            else el.innerHTML='<i class="fa-solid fa-plus"></i> Voir plus'
        })
    })
    document.querySelectorAll('i[data-bs-toggle="collapse"]').forEach(el=>{
        el.addEventListener('click',()=>{
            console.log(el.className)
            if(el.className=='fa-solid fa-circle-chevron-up collapsed')el.className='fa-solid fa-circle-chevron-down'
            else el.className='fa-solid fa-circle-chevron-up'
        })
    })
</script>
{% endblock %}
